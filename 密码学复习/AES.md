# 高级数据加密标准 AES
## AES概况
NIST公开征集
        
    1998~2000年经历三轮审查
    2001年最终选定一个算法并制定其位标准
 ### 设计要求
 安全性：可抵御目前已知攻击
 
 实用性：适应各种应用环境
 
 扩展性：分组长度和密钥长度可扩展
 
 ### 特点
 分组密码：现在使用明文密文长度为128位，密钥长度可变（128/256等等）
 
 面向二进制： 能够加解密任何计算机数据
 
 不是对合运算： 加解密使用不同的算法（但是结构基本一样）
 
 综合运用多种密码古典密码技术： 置换、代替、异或
 
 整体结构：采用SP结构（S盒+P置换），基本轮函数循环迭代
 
 ### AES的子表示与运算
 AES的数据处理单位是字节和字
 
    一个字=4个字节=（4×8bit）32bit 
    一个字可以表示为系数取自GF(2^8)上的次数低于4次的多项式
    
 ### 状态
 加解密状态的中间数据
 
 以字节为元素的矩阵或是二维数组
 
 Nb——明文所含的字数
 
 Nk——密钥所含的字数
 
 Nr——迭代轮数
 
### 轮函数
共进行10轮变换

前9轮成为标准轮函数

最后一轮非标准轮函数
#### 标准轮函数
S盒变换+P置换（行移位变换+列混合变换）+轮密钥加 

#### 非标准轮函数
S盒变换+行移位变换+轮密钥加

### S盒变换
AES的唯一非线性变换

AES的S盒输入输出都是8位，是非线性置换

AES使用16个相同的S盒（一个S盒对应一个状态，一个状态对应一个字节）

#### S盒操作
1. 将输入字节用其GF(2^8)上的逆元素表示（非线性变换）
    
        把输入的字节看成GF(2^8)上的元素
        求出其在域上的逆元素
        用逆元素代替原输入字节
2. 对第一步的结果做仿射变换（线性变换）

#### 行移位
1. 对状态的行进行循环移位
2. 第0行不移位，第1行移C1自己，第二行移C2字节，第三行移C3字节
3. C1~3的取值由下表规定
        
        Nb  C1  C2   C3
        4    1   2    3
        6    1   2    3
        
4. 行移位变换属于置换，是线性变换，本质在于把数据打乱重排，起扩散作用
#### 列混合
1. 列混合变换把状态看作GF(2^8)上的 一个多项式a(x)，乘以一个固定的多项式c(x)，并模x^4+1

        c(x) = 03x^3 + 01x^2 + 01x + 02
2. 列混合变换属于线性变换，起扩散作用
3. c(x)与x^4+1互素，保证了c(x)存在逆多项式d(x)，只有存在d(x)才能进行解密

#### 轮密钥加
1. 轮密钥与状态进行模2相加
2. 轮密钥根据密钥产生算法生成
3. 轮密钥长度等于数据块长度

#### 轮密钥生成
1. 密钥扩展
2. 轮密钥选择

##### 密钥扩展        
        
##### 轮密钥选择
1. 根据分组的大小，一次从扩展密钥中去除轮密钥
2. 前Nb个字作为轮密钥0，接下来Nb个字作为轮密钥1，……

### AES的解密
AES的加密算法不是对合运算；但是AES的解密算法和加密算法的结构相同
把加密算法的每一个变换变成其逆运算即可

#### AES的基本逆变换
1. 轮密钥加

        轮密钥加变化的逆就是其本身
2. 行移位变换

        行移位变换的逆是状态的后三行分别移动（Nb-Ci）位，i=1，2，3
3. 列混合变换

        把状态的每一列乘以一个固定多项式d(x),d(x)=c(x)^-1
        
4. S盒
        
       第一步：进行逆仿射变换
       第二步：把每个字节用其在GF(2^8)中的逆来代替
5. 解密的密钥扩展
       
       第一步：使用与加密算法相同的密钥扩展
       第二步：把InvMixColumn（逆列混合变换）用到除去第一和最后一轮意外的所有轮密钥上

### AES的实现
基于算法的软件实现

基于查表的软件实现
        
    S盒查表
    列混合查表
    轮函数查表
    
### AES的安全性
能抵御目前所有的已知攻击
        
    穷举攻击、差分攻击、线性攻击、
    Square攻击、侧信道攻击
目前存在低于穷举复杂度的攻击方式，但是还不能对AES造成本质威胁

